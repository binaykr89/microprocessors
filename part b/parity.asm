.MODEL SMALL
.STACK 5000
.DATA

CR EQU ODOA3H
PA EQU ODOA0H
PB EQU ODOA1H
PC EQU ODOA2H

.CODE
MOV AX,@DATA
MOV DS,AX
MOV DX,CR
MOV AL,82H
OUT DX,AL

MOV DX,PB
IN AL,DX
MOV CL,8
MOV AH,0
N2:ROR AL,01
   JC N1
   DEC CL
   JNZ N2
   JMP NXT
M1:INC AH
   DEC CL
   JNZ N2
NXT:MOV AL,AH
    AND AL,1
    CMP AL,0
    JZ DFF
    MOV AL,00H
    JMP NEXT

DFF:MOV AL,0FFH
NEXT:MOV DX,PA
     OUT DX,AL
     MOV SI,8FFFH
RET2:MOV DI,0FFFFH
RET1:DEC DI
     JNZ RET1
     DEC SI
     JNZ RET2

MOV AL,AH
MOV DX,PA
OUT DX,AL
MOV AH,O4CH
INT 21H
END